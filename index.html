<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="sandbox allow-same-origin allow-scripts">
    <title>Diced:RPG Companion</title>
    <style>
        :root {
            --primary-color: #A2BC58;
            --secondary-color: #F1DEBD;
            --border-color: #4A2A1B;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
        }

        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .overall-rank-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 2px solid var(--primary-color);
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .attribute-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .attribute-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .attribute-icon {
            width: 24px;
            height: 24px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--secondary-color);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
        }

        .stats {
            font-size: 0.9em;
            color: #666;
        }

        .add-hours-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .add-hours-card .input-section {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .add-hours-card input,
        .add-hours-card select {
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .add-hours-card button {
            padding: 8px 16px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .add-hours-card button:hover {
            opacity: 0.9;
        }

        .gated-warning {
            color: #e67e22;
            font-size: 0.8em;
            margin-top: 8px;
            padding: 4px;
            background-color: #fff3e0;
            border-radius: 4px;
        }

        @media (max-width: 768px) {
            .attributes-grid {
                grid-template-columns: 1fr;
            }
            
            .add-hours-card .input-section {
                flex-direction: column;
                align-items: stretch;
            }
        }
        /* Quest System Styles */
        .quest-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .quest-card .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .quest-card .button-group {
            display: flex;
            gap: 10px;
        }

        .quest-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .quest-button.primary {
            background-color: var(--primary-color);
            color: white;
        }

        .quest-button.secondary {
            background-color: #f0f0f0;
            color: #333;
        }

        .quest-button:hover {
            opacity: 0.9;
        }

        .quest-icon {
            fill: currentColor;
        }

        .quest-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
        }

        .quest-item {
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 16px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        /* Quest type color indicators */
.quest-item {
    position: relative;
    padding-top: 6px;
    overflow: hidden;
}

.quest-type-banner {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
}

.quest-content {
    padding: 16px;
}

.quest-type-banner-large {
    height: 8px;
    margin: -20px -20px 16px -20px;
}

.quest-type-text {
    font-weight: 600;
}

/* Update the filter button colors to match quest types */
.filter-button[data-type="Training"] {
    border-color: #64D949;
    color: #64D949;
}
.filter-button[data-type="Training"].active {
    background-color: #64D949;
    color: white;
}

.filter-button[data-type="Main"] {
    border-color: #5F647C;
    color: #5F647C;
}
.filter-button[data-type="Main"].active {
    background-color: #5F647C;
    color: white;
}

.filter-button[data-type="Side"] {
    border-color: #FE3E53;
    color: #FE3E53;
}
.filter-button[data-type="Side"].active {
    background-color: #FE3E53;
    color: white;
}

.filter-button[data-type="Explore"] {
    border-color: #23D2E2;
    color: #23D2E2;
}
.filter-button[data-type="Explore"].active {
    background-color: #23D2E2;
    color: white;
}
        .quest-item:hover {
            background-color: #f5f5f5;
        }

        .quest-details {
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 20px;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .quest-dice-required {
            background-color: #fff3e0;
            color: #e67e22;
            padding: 8px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .quest-focus-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 16px;
        }

        .focus-box {
            padding: 12px;
            border-radius: 4px;
        }

        .focus-box.primary {
            background-color: #e3f2fd;
        }

        .focus-box.secondary {
            background-color: #f1f8e9;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .quest-card .header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .quest-focus-grid {
                grid-template-columns: 1fr;
            }
        }

        .quest-item.completed {
            border-left: 3px solid #A2BC58; /* Green border for completed quests */
        }

        .completion-badge {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #ffffff;
            background-color: #a2bc58;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        .completion-count {
            color: #A2BC58;
            font-weight: 600;
        }

        .completed-text {
            color: #0E7C7B;
            font-size: 0.9em;
        }

        /* Quest filter styles */
        .filter-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .filter-button {
            padding: 6px 12px;
            background-color: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 16px;
            font-size: 14px;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-button:hover {
            background-color: #e8e8e8;
        }

        .filter-button.active {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 30px;
            color: #666;
            font-style: italic;
        }

        /* Compact Quest List Styles */
.quest-list-header {
    display: block; /* Change from flex to block */
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border-color);
    text-align: left; /* Ensure text alignment */
}

.quest-list-counts {
    font-size: 14px;
    color: #666;
    display: block; /* Ensure it's block-level */
    width: 100%; /* Take full width */
}

.quest-list-compact {
    display: flex;
    flex-direction: column;
    gap: 8px;
    width: 100%; /* Ensure full width */
}

.quest-list-item {
    display: flex;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s;
    background-color: white;
}

.quest-list-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.quest-list-item.completed {
    background-color: #f9fafb;
}

.quest-item-color {
    width: 6px;
    min-height: 100%;
}

.quest-item-content {
    flex: 1;
    padding: 10px 12px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.quest-item-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.quest-item-name {
    font-weight: 600;
    font-size: 15px;
}

.quest-item-type {
    font-size: 12px;
    padding: 2px 8px;
    border-radius: 10px;
    background-color: #f3f4f6;
    color: #666;
}

.quest-item-details {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #666;
}

.quest-dice-pill,
.quest-completion-pill {
    display: inline-flex;
    align-items: center;
    font-size: 11px;
    padding: 2px 6px;
    border-radius: 10px;
}

.quest-dice-pill {
    background-color: #fff3e0;
    color: #e67e22;
}

.quest-completion-pill {
    background-color: #e6f7ef;
    color: #10b981;
}

.see-more-container {
    text-align: center;
    margin-top: 16px;
    padding-top: 12px;
    border-top: 1px solid var(--border-color);
    width: 100%; /* Ensure full width */
}

.see-more-button {
    background-color: #f9fafb;
    border: 1px solid var(--border-color);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    color: #666;
    cursor: pointer;
    transition: all 0.2s;
}

.see-more-button:hover {
    background-color: #f3f4f6;
    color: #333;
}
    </style>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#A2BC58">

</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>Diced:RPG Companion</h1>
        </div>

        <div class="overall-rank-card">
            <div class="attribute-header">
                <div class="attribute-icon">O</div>
                <h3>Overall Rank</h3>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 0%"></div>
            </div>
            <div class="stats">
                <p>Current Rank: <span id="overall-rank">Home Cook (Bronze)</span></p>
                <p>Total Hours: <span id="overall-hours">0</span> / <span id="overall-next-rank">220</span> for next rank</p>
            </div>
        </div>

        <div class="attributes-grid">
            <div class="attribute-card">
                <div class="attribute-header">
                    <div class="attribute-icon">T</div>
                    <h3>Technique</h3>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 25%"></div>
                </div>
                <div class="stats">
                    <p>Current Rank: Home Cook</p>
                    <p>Hours: <span id="technique-hours">0</span> / <span id="technique-next-level">5</span> for Level <span id="technique-level">1</span></p>
                </div>
            </div>

            <div class="attribute-card">
                <div class="attribute-header">
                    <div class="attribute-icon">I</div>
                    <h3>Ingredients</h3>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 15%"></div>
                </div>
                <div class="stats">
                    <p>Current Rank: Home Cook</p>
                    <p>Hours: <span id="ingredients-hours">0</span> / <span id="ingredients-next-level">5</span> for Level <span id="ingredients-level">1</span></p>
                </div>
            </div>

            <div class="attribute-card">
                <div class="attribute-header">
                    <div class="attribute-icon">F</div>
                    <h3>Flavor</h3>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 35%"></div>
                </div>
                <div class="stats">
                    <p>Current Rank: Home Cook</p>
                    <p>Hours: <span id="flavor-hours">0</span> / <span id="flavor-next-level">5</span> for Level <span id="flavor-level">1</span></p>
                </div>
            </div>

            <div class="attribute-card">
                <div class="attribute-header">
                    <div class="attribute-icon">M</div>
                    <h3>Management</h3>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 45%"></div>
                </div>
                <div class="stats">
                    <p>Current Rank: Home Cook</p>
                    <p>Hours: <span id="management-hours">0</span> / <span id="management-next-level">5</span> for Level <span id="management-level">1</span></p>
                </div>
            </div>
        </div>
        
        <!-- Quest System -->
        <div id="quest-system">
            <div class="quest-card">
                <div class="header">
                    <h3>Quest System</h3>
                    <div class="button-group">
                        <button id="view-all-quests" class="quest-button secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" class="quest-icon">
                                <path d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"/>
                            </svg>
                            View All
                        </button>
                        <button id="random-quest" class="quest-button primary">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" class="quest-icon">
                                <path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm0 2v14h14V5H5zm4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-5 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                            </svg>
                            Random Quest
                        </button>
                    </div>
                </div>
                <div id="quest-filters" class="filter-container"></div>
                <div class="content">
                    <div id="current-quest" class="hidden">
                        <!-- Quest details will be populated here -->
                    </div>
                    <div id="quest-list" class="quest-grid">
                        <!-- Quest list will be populated here -->
                    </div>
                </div>
            </div>
        </div>
        
        <div class="add-hours-card">
            <div class="attribute-header">
                <div class="attribute-icon">+</div>
                <h3>Add Practice Hours</h3>
            </div>
            <div class="input-section">
                <select id="attribute-select">
                    <option value="technique">Technique</option>
                    <option value="ingredients">Ingredients</option>
                    <option value="flavor">Flavor</option>
                    <option value="management">Management</option>
                </select>
                <input type="number" id="hours-input" min="0.5" step="0.5" value="1">
                <button id="add-hours-button">Add Hours</button>
                <button id="adjust-hours-button">Adjust Total</button>
            </div>
        </div>
    </div>

    <script>
        // Updated Rank and Level Definitions
const RANKS = [
    { name: 'Home Cook', hoursNeeded: 55, totalHoursNeeded: 220, color: '#CD7F32' },  // Bronze
    { name: 'Culinary Student', hoursNeeded: 209, totalHoursNeeded: 836, color: '#43464B' },  // Iron
    { name: 'Kitchen Assistant', hoursNeeded: 530, totalHoursNeeded: 2120, color: '#C0C0C0' },  // Silver
    { name: 'Line Cook', hoursNeeded: 1177, totalHoursNeeded: 4708, color: '#FFD700' },  // Gold
    { name: 'Sous Chef', hoursNeeded: 2500, totalHoursNeeded: 10000, color: '#E5E4E2' },  // Platinum
    { name: 'Head Chef', hoursNeeded: Infinity, totalHoursNeeded: Infinity, color: '#FF1493' }  // Master (Rainbow)
];

const LEVELS = [
    {
        rank: 'Home Cook',
        levels: [
            { level: 1, hours: 5, startAt: 0 },
            { level: 2, hours: 5, startAt: 5 },
            { level: 3, hours: 5, startAt: 10 },
            { level: 4, hours: 5, startAt: 15 },
            { level: 5, hours: 5, startAt: 20 },
            { level: 6, hours: 6, startAt: 25 },
            { level: 7, hours: 7, startAt: 31 },
            { level: 8, hours: 8, startAt: 38 },
            { level: 9, hours: 9, startAt: 46 }
        ]
    },
    {
        rank: 'Culinary Student',
        levels: [
            { level: 1, hours: 10, startAt: 55 },
            { level: 2, hours: 11, startAt: 65 },
            { level: 3, hours: 13, startAt: 76 },
            { level: 4, hours: 15, startAt: 89 },
            { level: 5, hours: 17, startAt: 104 },
            { level: 6, hours: 19, startAt: 121 },
            { level: 7, hours: 21, startAt: 140 },
            { level: 8, hours: 23, startAt: 161 },
            { level: 9, hours: 25, startAt: 184 }
        ]
    },
    {
        rank: 'Kitchen Assistant',
        levels: [
            { level: 1, hours: 27, startAt: 209 },
            { level: 2, hours: 29, startAt: 236 },
            { level: 3, hours: 31, startAt: 265 },
            { level: 4, hours: 33, startAt: 296 },
            { level: 5, hours: 35, startAt: 329 },
            { level: 6, hours: 37, startAt: 364 },
            { level: 7, hours: 40, startAt: 401 },
            { level: 8, hours: 43, startAt: 441 },
            { level: 9, hours: 46, startAt: 484 }
        ]
    },
    {
        rank: 'Line Cook',
        levels: [
            { level: 1, hours: 49, startAt: 530 },
            { level: 2, hours: 54, startAt: 579 },
            { level: 3, hours: 59, startAt: 633 },
            { level: 4, hours: 64, startAt: 692 },
            { level: 5, hours: 71, startAt: 756 },
            { level: 6, hours: 77, startAt: 827 },
            { level: 7, hours: 83, startAt: 904 },
            { level: 8, hours: 91, startAt: 987 },
            { level: 9, hours: 99, startAt: 1078 }
        ]
    },
    {
        rank: 'Sous Chef',
        levels: [
            { level: 1, hours: 106, startAt: 1177 },
            { level: 2, hours: 114, startAt: 1283 },
            { level: 3, hours: 123, startAt: 1397 },
            { level: 4, hours: 133, startAt: 1520 },
            { level: 5, hours: 143, startAt: 1653 },
            { level: 6, hours: 157, startAt: 1796 },
            { level: 7, hours: 167, startAt: 1953 },
            { level: 8, hours: 180, startAt: 2120 },
            { level: 9, hours: 200, startAt: 2300 }
        ]
    },
    {
        rank: 'Head Chef',
        levels: [
            { level: 1, hours: Infinity, startAt: 2500 }
        ]
    }
];

        // Check if storage is available
        function isStorageAvailable() {
            try {
                const test = '__storage_test__';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch(e) {
                return false;
            }
        }

        // State Management
        const state = {
    attributeHours: {
        technique: 0,
        ingredients: 0,
        flavor: 0,
        management: 0
    },
    completedQuests: [], // Array to store completed quest IDs with timestamps
    
    load() {
        try {
            if (isStorageAvailable()) {
                const savedState = localStorage.getItem('culinaryRPG');
                if (savedState) {
                    const parsed = JSON.parse(savedState);
                    this.attributeHours = parsed.attributeHours || this.attributeHours;
                    this.completedQuests = parsed.completedQuests || [];
                }
            }
        } catch (error) {
            console.warn('Could not load state:', error);
        }
    },
    
    save() {
        try {
            if (isStorageAvailable()) {
                localStorage.setItem('culinaryRPG', JSON.stringify({
                    attributeHours: this.attributeHours,
                    completedQuests: this.completedQuests
                }));
            }
        } catch (error) {
            console.warn('Could not save state:', error);
        }
    }
};

        // Utility Functions
        function calculateLevel(totalHours) {
            const minHours = Math.min(...Object.values(state.attributeHours));
            
            // First find what rank the minimum hours corresponds to
            let minRank = RANKS[0];
            for (const rank of RANKS) {
                if (minHours < rank.hoursNeeded) {
                    minRank = rank;
                    break;
                }
            }

            // If this attribute is trying to progress beyond the minimum rank, gate it
            if (totalHours > minRank.hoursNeeded) {
                totalHours = minRank.hoursNeeded;
            }

            // Now find the current rank based on the (possibly gated) total hours
            let currentRank = RANKS[RANKS.length - 1];
            for (const rank of RANKS) {
                if (totalHours < rank.hoursNeeded) {
                    currentRank = rank;
                    break;
                }
            }

            // Find level within rank
            const rankConfig = LEVELS.find(r => r.rank === currentRank.name);
            if (!rankConfig) return null;

            for (let i = 0; i < rankConfig.levels.length; i++) {
                const level = rankConfig.levels[i];
                const nextLevel = rankConfig.levels[i + 1];
                
                if (!nextLevel || totalHours < nextLevel.startAt) {
                    const hoursIntoLevel = totalHours - level.startAt;
                    
                    // If we're exactly at the start of a new rank, show 0 hours
                    const isExactlyAtRankStart = totalHours === level.startAt;
                    
                    return {
                        rank: currentRank.name,
                        level: level.level,
                        currentLevelHours: isExactlyAtRankStart ? 0 : hoursIntoLevel,
                        hoursForLevel: level.hours,
                        totalHours: totalHours,
                        color: currentRank.color,
                        isGated: totalHours === minRank.hoursNeeded && state.attributeHours[Object.keys(state.attributeHours).find(key => state.attributeHours[key] === totalHours)] > minRank.hoursNeeded,
                        maxAllowedHours: minRank.hoursNeeded,
                        isExactlyAtRankStart: isExactlyAtRankStart
                    };
                }
            }

            return {
                rank: 'Head Chef',
                level: 1,
                currentLevelHours: totalHours - 2500,
                hoursForLevel: Infinity,
                totalHours: totalHours,
                color: RANKS[RANKS.length - 1].color,
                isGated: false,
                isExactlyAtRankStart: false
            };
        }

        function calculateOverallRank() {
            const minAttributeHours = Math.min(...Object.values(state.attributeHours));
            const totalHours = Object.values(state.attributeHours).reduce((sum, hours) => sum + hours, 0);
            
            // Find current rank based on minimum attribute hours (for rank name)
            let currentRank = RANKS[0];
            let previousRankTotal = 0;
            
            for (const rank of RANKS) {
                if (minAttributeHours < rank.hoursNeeded) {
                    currentRank = rank;
                    break;
                }
                previousRankTotal = rank.totalHoursNeeded;
            }
            
            // Calculate hours needed for next rank relative to current rank's start
            const hoursIntoCurrentRank = Math.max(0, totalHours - previousRankTotal);
            const hoursNeededForNextRank = currentRank.totalHoursNeeded - previousRankTotal;
            
            return {
                name: currentRank.name,
                color: currentRank.color,
                totalHours: hoursIntoCurrentRank,
                nextRankHours: hoursNeededForNextRank,
                progress: (hoursIntoCurrentRank / hoursNeededForNextRank) * 100,
                hoursToNextRank: hoursNeededForNextRank - hoursIntoCurrentRank
            };
        }

        function getRankColor(hexColor) {
            const colors = {
                '#CD7F32': 'Bronze',  // Home Cook
                '#43464B': 'Iron',    // Culinary Student
                '#C0C0C0': 'Silver',  // Kitchen Assistant
                '#FFD700': 'Gold',    // Line Cook
                '#E5E4E2': 'Platinum', // Sous Chef
                '#FF1493': 'Rainbow'   // Head Chef
            };
            return colors[hexColor] || 'Unknown';
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        function findAttributeCard(attribute) {
            return Array.from(document.querySelectorAll('.attribute-card')).find(card => 
                card.querySelector('h3').textContent.toLowerCase() === attribute
            );
        }

        // UI Update Function
        function updateDisplay() {
            // Update overall rank display
            const overallRank = calculateOverallRank();
            document.getElementById('overall-rank').textContent = `${overallRank.name} (${getRankColor(overallRank.color)})`;
            document.getElementById('overall-hours').textContent = overallRank.totalHours.toFixed(2);
            document.getElementById('overall-next-rank').textContent = overallRank.nextRankHours;
            
            // Update overall progress bar
            const overallProgressBar = document.querySelector('.overall-rank-card .progress-fill');
            overallProgressBar.style.width = `${Math.min(overallRank.progress, 100)}%`;
            overallProgressBar.style.backgroundColor = overallRank.color;

            // Update each attribute card
            Object.keys(state.attributeHours).forEach(attribute => {
                const totalHours = state.attributeHours[attribute];
                const levelInfo = calculateLevel(totalHours);
                
                const card = findAttributeCard(attribute);
                if (card) {
                    const progressFill = card.querySelector('.progress-fill');
                    const stats = card.querySelector('.stats');
                    
                    // Update progress bar - show empty if exactly at rank start
                    const progressPercent = levelInfo.isExactlyAtRankStart ? 0 : 
                        (levelInfo.currentLevelHours / levelInfo.hoursForLevel) * 100;
                    progressFill.style.width = `${Math.min(progressPercent, 100)}%`;
                    progressFill.style.backgroundColor = levelInfo.color;
                    
                    // Update text displays
                    document.getElementById(`${attribute}-hours`).textContent = 
                        levelInfo.currentLevelHours.toFixed(2);
                    document.getElementById(`${attribute}-next-level`).textContent = 
                        levelInfo.hoursForLevel;
                    document.getElementById(`${attribute}-level`).textContent = 
                        levelInfo.level;
                    
                    // Update rank display in stats
                    stats.querySelector('p:first-child').textContent = `Current Rank: ${levelInfo.rank}`;
                    
                    // Show gating warning if applicable
                    let warningDiv = card.querySelector('.gated-warning');
                    if (levelInfo.isGated) {
                        if (!warningDiv) {
                            warningDiv = document.createElement('div');
                            warningDiv.className = 'gated-warning';
                            card.appendChild(warningDiv);
                        }
                        warningDiv.textContent = `Progress gated until all attributes reach ${levelInfo.rank}`;
                    } else if (warningDiv) {
                        warningDiv.remove();
                    }
                }
            });
        }

        // Event Handler
        function handleAddHours() {
            const elements = {
                attributeSelect: document.getElementById('attribute-select'),
                hoursInput: document.getElementById('hours-input')
            };
            
            if (!Object.values(elements).every(Boolean)) {
                console.error('Missing required elements');
                return;
            }
            
            const formData = {
                attribute: elements.attributeSelect.value,
                hours: parseFloat(elements.hoursInput.value)
            };
            
            if (formData.hours <= 0) {
                alert('Please enter a valid number of hours');
                return;
            }
            
            try {
                // Get minimum hours across all attributes
                const minHours = Math.min(...Object.values(state.attributeHours));
                
                // Find minimum rank
                let minRank = RANKS[0];
                for (const rank of RANKS) {
                    if (minHours < rank.hoursNeeded) {
                        minRank = rank;
                        break;
                    }
                }

                const proposedTotal = state.attributeHours[formData.attribute] + formData.hours;
                
                // Check if this would exceed the gate
                if (proposedTotal > minRank.hoursNeeded) {
                    alert(`Cannot progress past ${minRank.name} rank (${minRank.hoursNeeded} hours) until all attributes reach this rank.`);
                    // Set hours to maximum allowed if not already there
                    if (state.attributeHours[formData.attribute] < minRank.hoursNeeded) {
                        state.attributeHours[formData.attribute] = minRank.hoursNeeded;
                        state.save();
                        updateDisplay();
                    }
                    return;
                }
                
                // Update hours if we haven't hit the gate
                state.attributeHours[formData.attribute] = proposedTotal;
                state.save();
                
                // Reset form
                elements.hoursInput.value = '1';
                
                // Update UI
                updateDisplay();
                
            } catch (error) {
                console.error('Error in addHours:', error);
                alert('Failed to save progress. Please try again.');
            }
        }

        // Quest System
const questSystem = {
    currentQuest: null,
    currentFilter: 'all', // Default filter is 'all'
    pageSize: 10,
    currentPage: 1,
    expandedView: false,
    
    initialize() {
        console.log('Initializing quest system...');
        
        // Add event listeners
        document.getElementById('random-quest').addEventListener('click', () => this.selectRandomQuest());
        document.getElementById('view-all-quests').addEventListener('click', () => this.showQuestList());
        
        const randomButton = document.getElementById('random-quest');
        const viewAllButton = document.getElementById('view-all-quests');
        
        if (randomButton) {
            randomButton.addEventListener('click', () => {
                console.log('Random quest button clicked');
                this.selectRandomQuest();
            });
        }
        
        if (viewAllButton) {
            viewAllButton.addEventListener('click', () => {
                console.log('View all button clicked');
                this.showQuestList();
            });
        }
        
        // Set up filter buttons
        this.setupFilterButtons();
        
        // Initial render
        this.showQuestList();
    },
    
    setupFilterButtons() {
            const filterContainer = document.getElementById('quest-filters');
            if (!filterContainer) {
                console.error('Filter container not found');
                return;
            }
            
            // Clear existing filters
            filterContainer.innerHTML = '';
            
            // Create "All" filter button
            const allButton = document.createElement('button');
            allButton.className = `filter-button ${this.currentFilter === 'all' ? 'active' : ''}`;
            allButton.textContent = 'All Quests';
            allButton.addEventListener('click', () => {
                this.setFilter('all');
            });
            filterContainer.appendChild(allButton);
            
            // Get unique quest types
            const questTypes = [...new Set(QUEST_DATA.map(q => q.type))];
            
            // Create filter buttons for each type
            questTypes.forEach(type => {
                const button = document.createElement('button');
                button.className = `filter-button ${this.currentFilter === type ? 'active' : ''}`;
                button.setAttribute('data-type', type);
                button.textContent = type;
                button.addEventListener('click', () => {
                    this.setFilter(type);
                });
                filterContainer.appendChild(button);
            });
        },
    
    setFilter(filter) {
        this.currentFilter = filter;
        // Update active button styles
        const filterButtons = document.querySelectorAll('.filter-button');
        filterButtons.forEach(button => {
            if (button.textContent === (filter === 'all' ? 'All Quests' : filter)) {
                button.classList.add('active');
            } else {
                button.classList.remove('active');
            }
        });
        // Refresh quest list with filter
        this.showQuestList();
    },
    
    getFilteredQuests() {
        if (this.currentFilter === 'all') {
            return QUEST_DATA;
        }
        return QUEST_DATA.filter(quest => quest.type === this.currentFilter);
    },
    
    selectRandomQuest() {
        const filteredQuests = this.getFilteredQuests();
        if (filteredQuests.length === 0) {
            alert('No quests available with the current filter');
            return;
        }
        const randomIndex = Math.floor(Math.random() * filteredQuests.length);
        this.showQuestDetails(filteredQuests[randomIndex]);
    },
    
    showQuestList() {
    const questList = document.getElementById('quest-list');
    const currentQuest = document.getElementById('current-quest');
    
    if (!questList || !currentQuest) {
        console.error('Required elements not found');
        return;
    }
    
    const filteredQuests = this.getFilteredQuests();
    const totalQuests = filteredQuests.length;
    const displayQuests = this.expandedView ? 
        filteredQuests : 
        filteredQuests.slice(0, this.pageSize);
    
    // Reset any potential grid/flexbox inheritance
    questList.style.display = "block";
    questList.style.width = "100%";
    
    // Build HTML with explicit container divs
    questList.innerHTML = `
        <div class="quest-container" style="width:100%; display:block;">
            <div class="quest-list-header" style="width:100%; display:block;">
                <div class="quest-list-counts" style="width:100%; display:block;">
                    Showing ${displayQuests.length} of ${totalQuests} quests
                    ${this.currentFilter !== 'all' ? ` (filtered to ${this.currentFilter})` : ''}
                </div>
            </div>
            
            ${filteredQuests.length === 0 ? `
                <div class="empty-state" style="width:100%; display:block;">
                    <p>No quests found for "${this.currentFilter}" filter</p>
                </div>
            ` : `
                <div class="quest-list-compact" style="width:100%; display:block;">
                    ${displayQuests.map(quest => {
                        const completions = state.completedQuests.filter(c => c.questId === quest.id);
                        const completionCount = completions.length;
                        const questColor = QUEST_TYPE_COLORS[quest.type] || '#888888';
                        
                        return `
                            <div class="quest-list-item ${completionCount > 0 ? 'completed' : ''}" 
                                 onclick="questSystem.showQuestDetails(${JSON.stringify(quest).replace(/"/g, '&quot;')})">
                                <div class="quest-item-color" style="background-color: ${questColor}"></div>
                                <div class="quest-item-content">
                                    <div class="quest-item-main">
                                        <span class="quest-item-name">${quest.questName}</span>
                                        <span class="quest-item-type">${quest.type}</span>
                                    </div>
                                    <div class="quest-item-details">
                                        <span>${quest.primaryFocus} (${quest.primaryHours}h) / ${quest.secondaryFocus} (${quest.secondaryHours}h)</span>
                                        ${quest.diceRequired ? 
                                            `<span class="quest-dice-pill">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12" fill="currentColor">
                                                    <path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm0 2v14h14V5H5zm4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-5 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                                                </svg>
                                            </span>` : ''
                                        }
                                        ${completionCount > 0 ? 
                                            `<span class="quest-completion-pill" title="Completed ${completionCount} time(s)">
                                                ✓${completionCount > 1 ? ` x${completionCount}` : ''}
                                            </span>` : ''
                                        }
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
                
                ${(!this.expandedView && totalQuests > this.pageSize) ? `
                    <div class="see-more-container" style="width:100%; display:block; text-align:center;">
                        <button class="see-more-button" onclick="questSystem.toggleExpandView()">
                            See All Quests (${totalQuests})
                        </button>
                    </div>
                ` : (this.expandedView && totalQuests > this.pageSize) ? `
                    <div class="see-more-container" style="width:100%; display:block; text-align:center;">
                        <button class="see-more-button" onclick="questSystem.toggleExpandView()">
                            Show Less
                        </button>
                    </div>
                ` : ''}
            `}
        </div>
    `;
    
    questList.classList.remove('hidden');
    currentQuest.classList.add('hidden');
    
    // Update filter button states
    this.setupFilterButtons();
},

// Add this method to toggle between expanded and collapsed views
toggleExpandView() {
    this.expandedView = !this.expandedView;
    this.showQuestList();
},

showQuestDetails(quest) {
    const questList = document.getElementById('quest-list');
    const currentQuest = document.getElementById('current-quest');
    
    if (!questList || !currentQuest) {
        console.error('Required elements not found');
        return;
    }

    // Get completion information
    const completions = state.completedQuests.filter(c => c.questId === quest.id);
    const completionCount = completions.length;
    const lastCompletion = completions.length > 0 
        ? new Date(completions[completions.length - 1].completedAt)
        : null;
    
    const questColor = QUEST_TYPE_COLORS[quest.type] || '#888888';
    
    currentQuest.innerHTML = `
        <div class="quest-details">
            <div class="quest-type-banner-large" style="background-color: ${questColor}"></div>
            <div class="quest-header">
                <div>
                    <h4 class="text-xl font-bold mb-1">${quest.questName}</h4>
                    <p class="text-sm text-gray-600">
                        ${quest.rank} • <span class="quest-type-text" style="color: ${questColor}">${quest.type}</span>
                        ${completionCount > 0 ? `
                            <span class="completed-text">
                                • Completed ${completionCount} time${completionCount > 1 ? 's' : ''}
                                (Last: ${lastCompletion.toLocaleDateString()})
                            </span>
                        ` : ''}
                    </p>
                </div>
                ${quest.diceRequired ? `
                    <div class="quest-dice-required">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                            <path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm0 2v14h14V5H5zm4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-5 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                        </svg>
                        Dice Roll Required
                    </div>
                ` : ''}
            </div>
            <p class="text-gray-700 mb-4">${quest.description}</p>
            <div class="quest-focus-grid">
                <div class="focus-box primary">
                    <p class="text-sm font-semibold text-blue-700">Primary Focus</p>
                    <p class="text-lg">${quest.primaryFocus} • ${quest.primaryHours}h</p>
                </div>
                <div class="focus-box secondary">
                    <p class="text-sm font-semibold text-green-700">Secondary Focus</p>
                    <p class="text-lg">${quest.secondaryFocus} • ${quest.secondaryHours}h</p>
                </div>
            </div>
            <div class="mt-6 flex justify-end">
                <button 
                    onclick="questSystem.completeQuest(${JSON.stringify(quest).replace(/"/g, '&quot;')})"
                    class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"
                >
                    Complete Quest
                </button>
            </div>
        </div>
    `;
    
    questList.classList.add('hidden');
    currentQuest.classList.remove('hidden');
},
    completeQuest(quest) {
    if (!quest) {
        console.error('No quest provided to complete');
        return;
    }
    state.completedQuests.push({
        questId: quest.id,
        completedAt: new Date().toISOString()
    });

    // Confirm with user
    const confirmMessage = `Complete ${quest.questName}?\nThis will add:\n` +
        `${quest.primaryHours}h to ${quest.primaryFocus}\n` +
        `${quest.secondaryHours}h to ${quest.secondaryFocus}`;
    
    if (!confirm(confirmMessage)) {
        return;
    }

    // Add primary hours
    const primaryAttribute = quest.primaryFocus.toLowerCase();
    if (state.attributeHours.hasOwnProperty(primaryAttribute)) {
        state.attributeHours[primaryAttribute] += quest.primaryHours;
    }

    // Add secondary hours
    const secondaryAttribute = quest.secondaryFocus.toLowerCase();
    if (state.attributeHours.hasOwnProperty(secondaryAttribute)) {
        state.attributeHours[secondaryAttribute] += quest.secondaryHours;
    }

    // Save state and update display
    state.save();
    updateDisplay();

    // Show completion message
    alert(`Quest completed! Hours added:\n` +
        `${quest.primaryHours}h to ${quest.primaryFocus}\n` +
        `${quest.secondaryHours}h to ${quest.secondaryFocus}`);

    // Return to quest list
    this.showQuestList();
}
};
// Define test quest data
const QUEST_DATA = [
  {
    "id": 1,
    "questName": "Basic Knife Skills I",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Master basic vegetable cuts: rough chop dice and slice"
  },
  {
    "id": 2,
    "questName": "Basic Knife Skills II",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice advanced cuts: julienne brunoise and chiffonade"
  },
  {
    "id": 3,
    "questName": "Heat Control Fundamentals",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice controlling heat levels through egg cookery"
  },
  {
    "id": 4,
    "questName": "Sautéing Basics",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn proper sautéing technique using vegetables"
  },
  {
    "id": 5,
    "questName": "Boiling & Simmering",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Master cooking grains vegetables and pasta in liquid"
  },
  {
    "id": 6,
    "questName": "Baking Fundamentals",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn basic baking measurements and oven management"
  },
  {
    "id": 7,
    "questName": "Salt Pepper & Acid",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to use salt pepper and acid to enhance flavor"
  },
  {
    "id": 8,
    "questName": "Herbs & Spices Intro",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Explore basic herbs and spices and when to add them"
  },
  {
    "id": 9,
    "questName": "Mise en Place",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice proper preparation and organization of ingredients"
  },
  {
    "id": 10,
    "questName": "Kitchen Safety & Cleaning",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn safe food handling cleaning and cross-contamination prevention"
  },
  {
    "id": 11,
    "questName": "Vegetable Identification",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to identify and select common vegetables"
  },
  {
    "id": 12,
    "questName": "Protein Basics",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to identify and select basic proteins"
  },
  {
    "id": 13,
    "questName": "Pantry Organization",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Organize and stock a basic pantry with essential ingredients"
  },
  {
    "id": 14,
    "questName": "Recipe Reading",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to read understand and follow basic recipes"
  },
  {
    "id": 15,
    "questName": "Flavor Balancing",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice balancing sweet sour salty and bitter flavors"
  },
  {
    "id": 16,
    "questName": "Easy Pasta Dinner",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Cook a simple pasta dish with sauce and protein"
  },
  {
    "id": 17,
    "questName": "Basic Stir Fry",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a simple vegetable and protein stir fry with rice"
  },
  {
    "id": 18,
    "questName": "Hearty Soup",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Make a hearty soup using vegetables and protein"
  },
  {
    "id": 19,
    "questName": "Basic Roast",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Roast a protein with vegetable sides"
  },
  {
    "id": 20,
    "questName": "Simple Breakfast",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare eggs toast and a simple side"
  },
  {
    "id": 21,
    "questName": "Basic Sandwich Lunch",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Construct a balanced sandwich with sides"
  },
  {
    "id": 22,
    "questName": "Easy Sheet Pan Dinner",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a one-pan meal with protein and vegetables"
  },
  {
    "id": 23,
    "questName": "Simple Salad",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare a fresh salad with homemade dressing"
  },
  {
    "id": 24,
    "questName": "Basic Vegetable Side",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Cook a simple vegetable side dish"
  },
  {
    "id": 25,
    "questName": "Easy Grain Side",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare a flavorful grain side dish"
  },
  {
    "id": 26,
    "questName": "Basic Cookies",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Bake a basic cookie recipe"
  },
  {
    "id": 27,
    "questName": "Simple Quick Bread",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Bake banana bread zucchini bread or similar"
  },
  {
    "id": 28,
    "questName": "Basic Sauce",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Create a simple sauce to accompany a dish"
  },
  {
    "id": 29,
    "questName": "Local Market Visit",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Visit a farmers market and select 3 seasonal items"
  },
  {
    "id": 30,
    "questName": "Basic Cookbook Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Study a cookbook and select three recipes to try"
  },
  {
    "id": 31,
    "questName": "Local Restaurant Analysis",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Visit a restaurant and analyze a dish's flavors and techniques"
  },
  {
    "id": 32,
    "questName": "Kitchen Tool Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research and learn about essential kitchen tools and their uses"
  },
  {
    "id": 33,
    "questName": "Roasting Vegetables",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice roasting various vegetables to enhance flavor"
  },
  {
    "id": 34,
    "questName": "Steaming Techniques",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to properly steam vegetables fish and dumplings"
  },
  {
    "id": 35,
    "questName": "Pan Frying",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Master pan frying technique for proteins and vegetables"
  },
  {
    "id": 36,
    "questName": "Braising Basics",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn the fundamentals of braising tougher cuts of meat"
  },
  {
    "id": 37,
    "questName": "Measuring & Scaling",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice accurate measuring and recipe scaling"
  },
  {
    "id": 38,
    "questName": "Meal Prep Basics",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to plan and prep multiple meals efficiently"
  },
  {
    "id": 39,
    "questName": "Cooking Temperatures",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn and practice proper cooking temperatures for food safety"
  },
  {
    "id": 40,
    "questName": "Umami Exploration",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Explore umami flavors and ingredients like mushrooms soy and tomatoes"
  },
  {
    "id": 41,
    "questName": "Herb Identification",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to identify and use common fresh herbs"
  },
  {
    "id": 42,
    "questName": "Spice Identification",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to identify and use common dried spices"
  },
  {
    "id": 43,
    "questName": "Grain Varieties",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn about different grain varieties and cooking methods"
  },
  {
    "id": 44,
    "questName": "Kitchen Timing",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice coordinating multiple dishes to finish at the same time"
  },
  {
    "id": 45,
    "questName": "Taste Development",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice tasting and adjusting seasoning throughout cooking"
  },
  {
    "id": 46,
    "questName": "Simple Weeknight Meal",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a balanced weeknight dinner in under 45 minutes"
  },
  {
    "id": 47,
    "questName": "Basic Roast Chicken",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Roast a whole chicken with simple seasonings"
  },
  {
    "id": 48,
    "questName": "One-Pot Meal",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a complete meal using just one pot"
  },
  {
    "id": 49,
    "questName": "Simple Fish Dinner",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Cook a simple fish fillet with sides"
  },
  {
    "id": 50,
    "questName": "Basic Rice Bowl",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a balanced bowl with rice protein and vegetables"
  },
  {
    "id": 51,
    "questName": "Weekend Brunch",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a multi-component brunch with protein and sides"
  },
  {
    "id": 52,
    "questName": "Simple Casserole",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create an easy layered casserole with protein and vegetables"
  },
  {
    "id": 53,
    "questName": "Basic Tacos",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare seasoned protein and toppings for tacos"
  },
  {
    "id": 54,
    "questName": "Grain Bowl",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Management",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Assemble a balanced grain bowl with protein vegetables and sauce"
  },
  {
    "id": 55,
    "questName": "Beginner's Curry",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a simple curry with vegetables and/or protein"
  },
  {
    "id": 56,
    "questName": "Roasted Potatoes",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare crispy roasted potatoes with herbs"
  },
  {
    "id": 57,
    "questName": "Sautéed Greens",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Sauté leafy greens with simple seasonings"
  },
  {
    "id": 58,
    "questName": "Rice Pilaf",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare flavorful rice with aromatics"
  },
  {
    "id": 59,
    "questName": "Simple Fruit Dessert",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Create an easy fruit-based dessert"
  },
  {
    "id": 60,
    "questName": "Quick Bread Rolls",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Bake simple no-yeast dinner rolls"
  },
  {
    "id": 61,
    "questName": "Vegetable Soup",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Make a simple vegetable soup from scratch"
  },
  {
    "id": 62,
    "questName": "Basic Vinaigrette",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Create a balanced oil and vinegar dressing"
  },
  {
    "id": 63,
    "questName": "Flavored Butters",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Make compound butters with herbs and spices"
  },
  {
    "id": 64,
    "questName": "Specialty Market Visit",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Visit an ethnic or specialty market and explore new ingredients"
  },
  {
    "id": 65,
    "questName": "Cooking YouTube Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Watch cooking tutorials and take notes on techniques"
  },
  {
    "id": 66,
    "questName": "Food Documentary",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Watch a food documentary and reflect on culinary traditions"
  },
  {
    "id": 67,
    "questName": "Ingredient Substitution Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research and document common ingredient substitutions"
  },
  {
    "id": 68,
    "questName": "Storage Methods Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn about proper food storage methods and shelf life"
  },
  {
    "id": 69,
    "questName": "Basic Meat Cookery",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn basic techniques for cooking different meat cuts"
  },
  {
    "id": 70,
    "questName": "Fish Cookery Basics",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn fundamental techniques for cooking fish"
  },
  {
    "id": 71,
    "questName": "Cooking with Eggs",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Master various egg cooking techniques"
  },
  {
    "id": 72,
    "questName": "Knife Sharpening & Care",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to maintain and sharpen kitchen knives"
  },
  {
    "id": 73,
    "questName": "Temperature Zones",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn about refrigerator temperature zones and food placement"
  },
  {
    "id": 74,
    "questName": "Vinegar Varieties",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn about different vinegars and their culinary uses"
  },
  {
    "id": 75,
    "questName": "Oil Varieties",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn about different cooking oils and their smoke points"
  },
  {
    "id": 76,
    "questName": "Kitchen Multitasking",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice managing multiple cooking tasks simultaneously"
  },
  {
    "id": 77,
    "questName": "Herb & Spice Pairing",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn which herbs and spices complement different foods"
  },
  {
    "id": 78,
    "questName": "Simple Stir-Fry Sauce",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Create a balanced stir-fry sauce from pantry ingredients"
  },
  {
    "id": 79,
    "questName": "Easy Vegetarian Dinner",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Ingredients",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a satisfying plant-based main dish"
  },
  {
    "id": 80,
    "questName": "Simple Noodle Bowl",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create an Asian-inspired noodle bowl with protein and vegetables"
  },
  {
    "id": 81,
    "questName": "Basic Frittata",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a versatile egg dish with vegetables and/or protein"
  },
  {
    "id": 82,
    "questName": "Easy Oven-Baked Protein",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Cook protein in the oven with simple seasonings"
  },
  {
    "id": 83,
    "questName": "Simple Stuffed Vegetables",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Ingredients",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare vegetables stuffed with a seasoned grain and protein mixture"
  },
  {
    "id": 84,
    "questName": "Easy Flatbread Pizza",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Assemble and bake a simple flatbread pizza with toppings"
  },
  {
    "id": 85,
    "questName": "Beginner's Baked Pasta",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a simple baked pasta dish with sauce and cheese"
  },
  {
    "id": 86,
    "questName": "Basic Quesadillas",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Make quesadillas with protein and/or vegetables"
  },
  {
    "id": 87,
    "questName": "Beginner's Chili",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a simple meat or vegetarian chili"
  },
  {
    "id": 88,
    "questName": "Easy Grain Salad",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare a cold grain salad with vegetables and dressing"
  },
  {
    "id": 89,
    "questName": "Simple Bean Side",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Cook beans with aromatics and seasonings"
  },
  {
    "id": 90,
    "questName": "Glazed Vegetables",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare vegetables with a simple flavorful glaze"
  },
  {
    "id": 91,
    "questName": "Basic Mashed Potatoes",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Make creamy mashed potatoes from scratch"
  },
  {
    "id": 92,
    "questName": "Simple Coleslaw",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare a basic cabbage slaw with dressing"
  },
  {
    "id": 93,
    "questName": "Roasted Vegetable Medley",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Roast a variety of seasoned vegetables together"
  },
  {
    "id": 94,
    "questName": "Basic Hummus",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Make simple hummus with variations"
  },
  {
    "id": 95,
    "questName": "Quick Pickled Vegetables",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare easy refrigerator pickles"
  },
  {
    "id": 96,
    "questName": "Seasonal Ingredients Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research what's in season and plan meals accordingly"
  },
  {
    "id": 97,
    "questName": "Cooking Podcast Study",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Listen to cooking podcasts and take notes on tips"
  },
  {
    "id": 98,
    "questName": "Food Science Basics",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research basic food science principles and cooking reactions"
  },
  {
    "id": 99,
    "questName": "Local Food Culture",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research local culinary traditions and specialties"
  },
  {
    "id": 100,
    "questName": "Recipe Adaptation Study",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn principles for adapting and modifying recipes"
  },
  {
    "id": 101,
    "questName": "Basic Kitchen Math",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice measuring conversions and recipe scaling"
  },
  {
    "id": 102,
    "questName": "Recipe Reading & Planning",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn to read analyze and prepare for recipes efficiently"
  },
  {
    "id": 103,
    "questName": "Basic Kitchen Organization",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Optimize kitchen workspace and tool organization"
  },
  {
    "id": 104,
    "questName": "Leftover Transformation",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Management",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn techniques for repurposing leftovers creatively"
  },
  {
    "id": 105,
    "questName": "Sweet & Savory Balance",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Flavor",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Practice balancing sweet and savory elements in dishes"
  },
  {
    "id": 106,
    "questName": "Dairy Alternatives",
    "rank": "Home Cook",
    "type": "Training",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn about and cook with plant-based dairy alternatives"
  },
  {
    "id": 107,
    "questName": "Breakfast for Dinner",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare breakfast foods as a satisfying dinner meal"
  },
  {
    "id": 108,
    "questName": "Simple Meat & Vegetable Plate",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Cook a protein with two vegetable sides"
  },
  {
    "id": 109,
    "questName": "Easy Soup & Sandwich",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a homemade soup and complementary sandwich"
  },
  {
    "id": 110,
    "questName": "Simple Stuffed Protein",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 2,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Prepare a stuffed chicken breast pork chop or fish fillet"
  },
  {
    "id": 111,
    "questName": "Bean-Based Main",
    "rank": "Home Cook",
    "type": "Main",
    "primaryFocus": "Technique",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1.5,
    "secondaryHours": 1,
    "diceRequired": true,
    "description": "Create a filling main dish centered around beans"
  },
  {
    "id": 112,
    "questName": "Quick Garlic Bread",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare simple homemade garlic bread"
  },
  {
    "id": 113,
    "questName": "Basic Cornbread",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Bake classic cornbread from scratch"
  },
  {
    "id": 114,
    "questName": "Simple Fruit Salad",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare a balanced fresh fruit salad"
  },
  {
    "id": 115,
    "questName": "Basic Corn Side Dish",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Prepare corn as a flavorful side dish"
  },
  {
    "id": 116,
    "questName": "Simple Fruit Crisp",
    "rank": "Home Cook",
    "type": "Side",
    "primaryFocus": "Technique",
    "secondaryFocus": "Flavor",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": true,
    "description": "Bake an easy fruit crisp with streusel topping"
  },
  {
    "id": 117,
    "questName": "Grocery Store Exploration",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Ingredients",
    "secondaryFocus": "Management",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Explore unfamiliar sections of your grocery store"
  },
  {
    "id": 118,
    "questName": "Kitchen Equipment Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research and evaluate essential kitchen equipment"
  },
  {
    "id": 119,
    "questName": "Meal Planning Study",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1.5,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Learn and practice effective meal planning strategies"
  },
  {
    "id": 120,
    "questName": "Budget Cooking Research",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Ingredients",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research techniques and recipes for economical cooking"
  },
  {
    "id": 121,
    "questName": "Food Storage Solutions",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Research and implement better food storage practices"
  },
  {
    "id": 122,
    "questName": "Knife Skills Video Study",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Technique",
    "secondaryFocus": "Management",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Watch and take notes on professional knife skills"
  },
  {
    "id": 123,
    "questName": "Chef Biography Study",
    "rank": "Home Cook",
    "type": "Explore",
    "primaryFocus": "Management",
    "secondaryFocus": "Technique",
    "primaryHours": 1,
    "secondaryHours": 0.5,
    "diceRequired": false,
    "description": "Read about famous chefs and their cooking philosophies"
  }
];

const QUEST_TYPE_COLORS = {
            'Training': '#64D949', // Green
            'Main': '#5F647C',     // Black
            'Side': '#FE3E53',     // Red
            'Explore': '#23D2E2'   // Teal
        };
        
// Update the initializeApp function to include quest system initialization
function initializeApp() {
    state.load();
    
    const addHoursButton = document.getElementById('add-hours-button');
    const adjustHoursButton = document.getElementById('adjust-hours-button');
    
    if (addHoursButton) {
        addHoursButton.addEventListener('click', handleAddHours);
    }
    
    if (adjustHoursButton) {
        adjustHoursButton.addEventListener('click', handleAdjustHours);
    }
    
    // Initialize quest system
    questSystem.initialize();

    // Add backup UI
    addBackupControls();
    
    updateDisplay();
}

        // Adjust Hours
        async function handleAdjustHours() {
    const attribute = document.getElementById('attribute-select').value;
    const currentHours = state.attributeHours[attribute];
    
    const newHours = prompt(
        `Current hours for ${capitalize(attribute)}: ${currentHours}\nEnter new total hours:`,
        currentHours
    );
    
    if (newHours === null) return; // User cancelled
    
    const newHoursNum = parseFloat(newHours);
    if (isNaN(newHoursNum) || newHoursNum < 0) {
        alert('Please enter a valid number of hours');
        return;
    }
    
    if (confirm(`Are you sure you want to set ${capitalize(attribute)} to ${newHoursNum} hours?`)) {
        state.attributeHours[attribute] = newHoursNum;
        state.save();
        updateDisplay();
    }
}
        // Start the application when DOM is ready
        document.addEventListener('DOMContentLoaded', initializeApp);
    
    // Functions for exporting and importing data
function exportProgress() {
    try {
        // Get current state
        const dataToExport = {
            attributeHours: state.attributeHours,
            completedQuests: state.completedQuests,
            exportDate: new Date().toISOString(),
            version: '1.0.0' // Add versioning for future compatibility
        };
        
        // Convert to JSON string
        const jsonData = JSON.stringify(dataToExport, null, 2);
        
        // Create download link
        const blob = new Blob([jsonData], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const downloadLink = document.createElement('a');
        
        // Set filename with date
        const date = new Date().toISOString().split('T')[0]; // YYYY-MM-DD format
        downloadLink.download = `diced_rpg_progress_${date}.json`;
        downloadLink.href = url;
        
        // Trigger download
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        URL.revokeObjectURL(url);
        
        alert('Progress exported successfully! Keep this file safe to restore your progress if needed.');
    } catch (error) {
        console.error('Export failed:', error);
        alert('Failed to export progress. Please try again.');
    }
}

// Function to import state from file
function importProgress() {
    // Create file input element
    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = '.json';
    
    fileInput.onchange = (event) => {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const importedData = JSON.parse(e.target.result);
                
                // Validate imported data structure
                if (!importedData.attributeHours || !importedData.completedQuests) {
                    throw new Error('Invalid data format');
                }
                
                // Confirm import
                if (confirm(`Import progress from ${new Date(importedData.exportDate).toLocaleString()}?\n\nThis will replace your current progress.`)) {
                    // Update state
                    state.attributeHours = importedData.attributeHours;
                    state.completedQuests = importedData.completedQuests;
                    state.save();
                    updateDisplay();
                    alert('Progress imported successfully!');
                    
                    // Add automatic backup
                    localStorage.setItem('culinaryRPG_backup', JSON.stringify({
                        timestamp: new Date().toISOString(),
                        data: state
                    }));
                }
            } catch (error) {
                console.error('Import failed:', error);
                alert('Failed to import progress. The file may be corrupted or invalid.');
            }
        };
        reader.readAsText(file);
    };
    
    // Trigger file selection
    fileInput.click();
}

// Function to add backup UI controls
function addBackupControls() {
    const dashboard = document.querySelector('.dashboard');
    const addHoursCard = document.querySelector('.add-hours-card');
    
    // Create backup controls card
    const backupCard = document.createElement('div');
    backupCard.className = 'add-hours-card';
    backupCard.innerHTML = `
        <div class="attribute-header">
            <div class="attribute-icon">💾</div>
            <h3>Progress Backup</h3>
        </div>
        <p class="stats">Protect your progress from browser data clearing</p>
        <div class="input-section">
            <button id="export-progress-button">Export Progress</button>
            <button id="import-progress-button">Import Progress</button>
        </div>
    `;
    
    // Insert before add hours card
    dashboard.insertBefore(backupCard, addHoursCard.nextSibling);
    
    // Add event listeners
    document.getElementById('export-progress-button').addEventListener('click', exportProgress);
    document.getElementById('import-progress-button').addEventListener('click', importProgress);
}

    // Register service worker for PWA functionality
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./service-worker.js')
      .then(registration => {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
      })
      .catch(error => {
        console.log('ServiceWorker registration failed: ', error);
      });
  });
}
    </script>
</body>
</html>
